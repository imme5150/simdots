<html>
  <head>
    <title>SimDots</title>
  </head>
  <body>
    <canvas id="main" style="width:100%;height:100%;display:block">
    <script>
      const canvas = document.getElementById("main");
      const resizeObserver = new ResizeObserver(() => {
        canvas.width = Math.round(canvas.clientWidth * devicePixelRatio);
        canvas.height = Math.round(canvas.clientHeight * devicePixelRatio);
      });

      resizeObserver.observe(canvas);

      const ctx = canvas.getContext("2d");
      var drawing = false;
      const dots = [];

      canvas.addEventListener("mousedown", (event) => {
        drawing = true;
      });
      canvas.addEventListener("mouseup", (event) => {
        drawing = false;
      });
      canvas.addEventListener("mouseleave", (event) => {
        drawing = false;
      });
      canvas.addEventListener("mousemove", (event) => {
        if (!drawing) return
        const x = event.clientX - canvas.offsetLeft;
        const y = event.clientY - canvas.offsetTop;
        const speed = Math.random() + 4
        const angle = Math.random() * Math.PI / 4 + Math.PI / 2.5;
        const dx = Math.cos(angle) * speed;
        const dy = Math.sin(angle) * speed;
        dots.push({x:x, y:y, dx:dx, dy:dy});
      });
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let dot of dots) {
          // Update dot position
           dot.x += dot.dx;
           dot.y += dot.dy;
          // Bounce off edges
          if (dot.x + dot.radius > canvas.width || dot.x - dot.radius < 0) {
            // dot.dx = -dot.dx;
          }
          if (dot.y + dot.radius > canvas.height || dot.y - dot.radius < 0) {
            // dot.dy = -dot.dy;
          }

          // Draw dot
          ctx.beginPath();
          ctx.arc(dot.x, dot.y, 3, 0, 2 * Math.PI);
          ctx.fill();
        }

        requestAnimationFrame(animate);
      }

      animate();
    </script>
  </body>
</html>
